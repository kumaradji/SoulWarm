{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{useNavigate}from'react-router-dom';// Используем useNavigate из React Router\nimport styles from'./ModalChat.module.scss';import Modal from'../../Modal/Modal';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ModalChat=_ref=>{let{onClose}=_ref;const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState('');const[isAuthenticated,setIsAuthenticated]=useState(false);const lastMessageId=useRef(0);const textareaRef=useRef(null);const messagesEndRef=useRef(null);const[isPolling,setIsPolling]=useState(true);const[showModal,setShowModal]=useState(false);const navigate=useNavigate();// Используем useNavigate для навигации\nuseEffect(()=>{const token=localStorage.getItem('token');if(token){setIsAuthenticated(true);const fetchMessages=async()=>{try{const response=await fetch('http://localhost:8000/api/messages/',{headers:{'Authorization':\"Token \".concat(token)}});if(response.ok){const data=await response.json();setMessages(data);if(data.length>0){lastMessageId.current=data[data.length-1].id;}}else{console.error('Failed to fetch messages');}}catch(error){console.error('Error fetching messages:',error);}};fetchMessages();longPolling();}},[isAuthenticated]);useEffect(()=>{if(messagesEndRef.current){messagesEndRef.current.scrollIntoView({behavior:'smooth'});}},[messages]);const longPolling=async()=>{while(isPolling){const controller=new AbortController();try{console.log('Polling for new messages...');const response=await fetch(\"http://localhost:8000/api/long-polling/messages/?last_message_id=\".concat(lastMessageId.current),{signal:controller.signal});if(response.ok){const newMessages=await response.json();console.log('Received new messages:',newMessages);if(newMessages.length>0){setMessages(prevMessages=>{const messageIds=new Set(prevMessages.map(msg=>msg.id));const filteredNewMessages=newMessages.filter(msg=>!messageIds.has(msg.id));return[...prevMessages,...filteredNewMessages];});lastMessageId.current=newMessages[newMessages.length-1].id;console.log('Updated lastMessageId:',lastMessageId.current);}else{console.log('No new messages');}}else{console.error('Error in long polling response:',response.status,response.statusText);}}catch(error){if(error.name==='AbortError'){console.log('Polling aborted');}else{console.error('Error during long polling:',error);}}console.log('Waiting for 5 seconds before next poll...');await new Promise(resolve=>setTimeout(resolve,5000));}};const handleSendMessage=async e=>{e.preventDefault();const token=localStorage.getItem('token');if(!token){setShowModal(true);return;}const response=await fetch('http://localhost:8000/api/messages/create/',{method:'POST',headers:{'Authorization':\"Token \".concat(token),'Content-Type':'application/json'},body:JSON.stringify({content:newMessage,is_admin:false})});if(response.ok){const data=await response.json();setMessages(prevMessages=>{const messageExists=prevMessages.some(msg=>msg.id===data.id);if(!messageExists){return[...prevMessages,data];}return prevMessages;});setNewMessage('');}else{console.error('Failed to send message');}};const handleKeyDown=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSendMessage(e);}};const handleRegisterRedirect=()=>{setShowModal(false);onClose();// Закрываем окно\nnavigate('/auth');// Перенаправляем пользователя на страницу регистрации\n};return/*#__PURE__*/_jsx(\"div\",{className:styles.modalOverlay,onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.modal,onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.modalHeader,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0414\\u0430\\u0432\\u0430\\u0439\\u0442\\u0435 \\u043F\\u043E\\u0431\\u043E\\u043B\\u0442\\u0430\\u0435\\u043C\"}),/*#__PURE__*/_jsx(\"button\",{className:styles.closeButton,onClick:onClose,children:\"\\xD7\"})]}),isAuthenticated?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.chatWindow,children:[messages.map((message,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(styles.message,\" \").concat(message.is_admin?styles.adminMessage:styles.userMessage,\" \").concat(message.user_name===localStorage.getItem('username')?styles.myMessage:styles.theirMessage),children:[/*#__PURE__*/_jsxs(\"strong\",{children:[message.user_name||\"Unknown\",\":\"]}),\" \",message.content,/*#__PURE__*/_jsx(\"div\",{className:styles.timestamp,children:new Date(message.timestamp).toLocaleString()})]},index)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSendMessage,className:styles.chatInput,children:[/*#__PURE__*/_jsx(\"textarea\",{ref:textareaRef,value:newMessage,onChange:e=>setNewMessage(e.target.value),onKeyDown:handleKeyDown,placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0432\\u0430\\u0448\\u0435 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435...\",required:true}),/*#__PURE__*/_jsx(\"button\",{className:styles.modalButtonSend,type:\"submit\",children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:styles.authRequired,children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u0414\\u043B\\u044F \\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u044F \\u0432 \\u0447\\u0430\\u0442\\u0435 \\u0432\\u044B \\u0434\\u043E\\u043B\\u0436\\u043D\\u044B \\u0437\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F.\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleRegisterRedirect,className:styles.modalButtonSend,children:\"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\"})]}),/*#__PURE__*/_jsx(Modal,{isOpen:showModal,onClose:()=>setShowModal(false),message:/*#__PURE__*/_jsxs(\"div\",{children:[\"\\u0414\\u043B\\u044F \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043A\\u0438 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439 \\u0432\\u044B \\u0434\\u043E\\u043B\\u0436\\u043D\\u044B \\u0437\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F.\",/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleRegisterRedirect,className:styles.modalButtonSend,children:\"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\"})]})})]})});};export default ModalChat;","map":{"version":3,"names":["React","useState","useEffect","useRef","useNavigate","styles","Modal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ModalChat","_ref","onClose","messages","setMessages","newMessage","setNewMessage","isAuthenticated","setIsAuthenticated","lastMessageId","textareaRef","messagesEndRef","isPolling","setIsPolling","showModal","setShowModal","navigate","token","localStorage","getItem","fetchMessages","response","fetch","headers","concat","ok","data","json","length","current","id","console","error","longPolling","scrollIntoView","behavior","controller","AbortController","log","signal","newMessages","prevMessages","messageIds","Set","map","msg","filteredNewMessages","filter","has","status","statusText","name","Promise","resolve","setTimeout","handleSendMessage","e","preventDefault","method","body","JSON","stringify","content","is_admin","messageExists","some","handleKeyDown","key","shiftKey","handleRegisterRedirect","className","modalOverlay","onClick","children","modal","stopPropagation","modalHeader","closeButton","chatWindow","message","index","adminMessage","userMessage","user_name","myMessage","theirMessage","timestamp","Date","toLocaleString","ref","onSubmit","chatInput","value","onChange","target","onKeyDown","placeholder","required","modalButtonSend","type","authRequired","isOpen"],"sources":["/home/kiipod/projects/slwrm/frontend/src/components/ChatButton/ModalChat/ModalChat.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom'; // Используем useNavigate из React Router\nimport styles from './ModalChat.module.scss';\nimport Modal from '../../Modal/Modal';\n\nconst ModalChat = ({ onClose }) => {\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const lastMessageId = useRef(0);\n  const textareaRef = useRef(null);\n  const messagesEndRef = useRef(null);\n  const [isPolling, setIsPolling] = useState(true);\n  const [showModal, setShowModal] = useState(false);\n  const navigate = useNavigate(); // Используем useNavigate для навигации\n\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      setIsAuthenticated(true);\n      const fetchMessages = async () => {\n        try {\n          const response = await fetch('http://localhost:8000/api/messages/', {\n            headers: {\n              'Authorization': `Token ${token}`\n            }\n          });\n          if (response.ok) {\n            const data = await response.json();\n            setMessages(data);\n            if (data.length > 0) {\n              lastMessageId.current = data[data.length - 1].id;\n            }\n          } else {\n            console.error('Failed to fetch messages');\n          }\n        } catch (error) {\n          console.error('Error fetching messages:', error);\n        }\n      };\n      fetchMessages();\n      longPolling();\n    }\n  }, [isAuthenticated]);\n\n  useEffect(() => {\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n    }\n  }, [messages]);\n\n  const longPolling = async () => {\n    while (isPolling) {\n      const controller = new AbortController();\n      try {\n        console.log('Polling for new messages...');\n        const response = await fetch(`http://localhost:8000/api/long-polling/messages/?last_message_id=${lastMessageId.current}`, {\n          signal: controller.signal\n        });\n        if (response.ok) {\n          const newMessages = await response.json();\n          console.log('Received new messages:', newMessages);\n          if (newMessages.length > 0) {\n            setMessages(prevMessages => {\n              const messageIds = new Set(prevMessages.map(msg => msg.id));\n              const filteredNewMessages = newMessages.filter(msg => !messageIds.has(msg.id));\n              return [...prevMessages, ...filteredNewMessages];\n            });\n            lastMessageId.current = newMessages[newMessages.length - 1].id;\n            console.log('Updated lastMessageId:', lastMessageId.current);\n          } else {\n            console.log('No new messages');\n          }\n        } else {\n          console.error('Error in long polling response:', response.status, response.statusText);\n        }\n      } catch (error) {\n        if (error.name === 'AbortError') {\n          console.log('Polling aborted');\n        } else {\n          console.error('Error during long polling:', error);\n        }\n      }\n\n      console.log('Waiting for 5 seconds before next poll...');\n      await new Promise(resolve => setTimeout(resolve, 5000));\n    }\n  };\n\n  const handleSendMessage = async (e) => {\n    e.preventDefault();\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setShowModal(true);\n      return;\n    }\n    const response = await fetch('http://localhost:8000/api/messages/create/', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({ content: newMessage, is_admin: false })\n    });\n    if (response.ok) {\n      const data = await response.json();\n      setMessages(prevMessages => {\n        const messageExists = prevMessages.some(msg => msg.id === data.id);\n        if (!messageExists) {\n          return [...prevMessages, data];\n        }\n        return prevMessages;\n      });\n      setNewMessage('');\n    } else {\n      console.error('Failed to send message');\n    }\n  };\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage(e);\n    }\n  };\n\n  const handleRegisterRedirect = () => {\n    setShowModal(false);\n    onClose(); // Закрываем окно\n    navigate('/auth'); // Перенаправляем пользователя на страницу регистрации\n  };\n\n  return (\n    <div className={styles.modalOverlay} onClick={onClose}>\n      <div className={styles.modal} onClick={(e) => e.stopPropagation()}>\n        <div className={styles.modalHeader}>\n          <h2>Давайте поболтаем</h2>\n          <button className={styles.closeButton} onClick={onClose}>×</button>\n        </div>\n        {isAuthenticated ? (\n          <>\n            <div className={styles.chatWindow}>\n              {messages.map((message, index) => (\n                <div\n                  key={index}\n                  className={`${styles.message} ${message.is_admin ? styles.adminMessage : styles.userMessage} ${message.user_name === localStorage.getItem('username') ? styles.myMessage : styles.theirMessage}`}\n                >\n                  <strong>{message.user_name || \"Unknown\"}:</strong> {message.content}\n                  <div className={styles.timestamp}>{new Date(message.timestamp).toLocaleString()}</div>\n                </div>\n              ))}\n              <div ref={messagesEndRef} />\n            </div>\n            <form onSubmit={handleSendMessage} className={styles.chatInput}>\n              <textarea\n                ref={textareaRef}\n                value={newMessage}\n                onChange={(e) => setNewMessage(e.target.value)}\n                onKeyDown={handleKeyDown}\n                placeholder=\"Введите ваше сообщение...\"\n                required\n              />\n              <button className={styles.modalButtonSend} type=\"submit\">Отправить</button>\n            </form>\n          </>\n        ) : (\n          <div className={styles.authRequired}>\n            <p>Для общения в чате вы должны зарегистрироваться.</p>\n            <button type=\"button\" onClick={handleRegisterRedirect} className={styles.modalButtonSend}>Зарегистрироваться</button>\n          </div>\n        )}\n        <Modal\n          isOpen={showModal}\n          onClose={() => setShowModal(false)}\n          message={\n            <div>\n              Для отправки сообщений вы должны зарегистрироваться.\n              <button type=\"button\" onClick={handleRegisterRedirect} className={styles.modalButtonSend}>Зарегистрироваться</button>\n            </div>\n          }\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default ModalChat;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}