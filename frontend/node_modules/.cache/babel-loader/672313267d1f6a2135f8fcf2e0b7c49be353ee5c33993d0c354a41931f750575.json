{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../../../context/AuthContext';import styles from'./UserBlock.module.scss';import user_icon from'../../../assets/user_icon.png';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const UserBlock=_ref=>{let{userName,setMode}=_ref;const{isLoggedIn,logout,user}=useAuth();const navigate=useNavigate();const[avatarUrl,setAvatarUrl]=useState(user_icon);useEffect(()=>{if(isLoggedIn&&user){fetch(\"http://localhost:8000/api/profile/avatar/\",{headers:{'Authorization':\"Token \".concat(localStorage.getItem('token'))}}).then(response=>{if(!response.ok){throw new Error('Network response was not ok');}return response.json();}).then(data=>{if(data.avatar){setAvatarUrl(\"http://localhost:8000\".concat(data.avatar));}}).catch(error=>{console.error('Error fetching avatar:',error);});}},[isLoggedIn,user]);const handleLogoutClick=()=>{logout();navigate('/');};const handleLoginClick=()=>{setMode('login');navigate('/auth');};const handleProfileClick=()=>{navigate('/profile');};return/*#__PURE__*/_jsx(\"div\",{className:styles.userBlock,children:isLoggedIn?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:styles.userInfo,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.userInfo__details,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.userInfo__userName,onClick:handleProfileClick,style:{cursor:'pointer'},children:userName||'Пользователь'}),/*#__PURE__*/_jsx(\"img\",{src:avatarUrl,alt:\"User\",className:styles.userInfo__userIcon})]})}),/*#__PURE__*/_jsx(\"button\",{className:styles.logoutButton,onClick:handleLogoutClick,children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"})]}):/*#__PURE__*/_jsx(\"button\",{className:styles.loginButton,onClick:handleLoginClick,children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})});};export default UserBlock;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useAuth","styles","user_icon","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","UserBlock","_ref","userName","setMode","isLoggedIn","logout","user","navigate","avatarUrl","setAvatarUrl","fetch","headers","concat","localStorage","getItem","then","response","ok","Error","json","data","avatar","catch","error","console","handleLogoutClick","handleLoginClick","handleProfileClick","className","userBlock","children","userInfo","userInfo__details","userInfo__userName","onClick","style","cursor","src","alt","userInfo__userIcon","logoutButton","loginButton"],"sources":["/home/kiipod/projects/slwrm/frontend/src/components/Header/UserBlock/UserBlock.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../../context/AuthContext';\nimport styles from './UserBlock.module.scss';\nimport user_icon from '../../../assets/user_icon.png';\n\nconst UserBlock = ({ userName, setMode }) => {\n  const { isLoggedIn, logout, user } = useAuth();\n  const navigate = useNavigate();\n  const [avatarUrl, setAvatarUrl] = useState(user_icon);\n\n  useEffect(() => {\n    if (isLoggedIn && user) {\n      fetch(`http://localhost:8000/api/profile/avatar/`, {\n        headers: {\n          'Authorization': `Token ${localStorage.getItem('token')}`\n        }\n      })\n        .then(response => {\n          if (!response.ok) {\n            throw new Error('Network response was not ok');\n          }\n          return response.json();\n        })\n        .then(data => {\n          if (data.avatar) {\n            setAvatarUrl(`http://localhost:8000${data.avatar}`);\n          }\n        })\n        .catch(error => {\n          console.error('Error fetching avatar:', error);\n        });\n    }\n  }, [isLoggedIn, user]);\n\n  const handleLogoutClick = () => {\n    logout();\n    navigate('/');\n  };\n\n  const handleLoginClick = () => {\n    setMode('login');\n    navigate('/auth');\n  };\n\n  const handleProfileClick = () => {\n    navigate('/profile');\n  };\n\n  return (\n    <div className={styles.userBlock}>\n      {isLoggedIn ? (\n        <>\n          <div className={styles.userInfo}>\n            <div className={styles.userInfo__details}>\n              <div\n                className={styles.userInfo__userName}\n                onClick={handleProfileClick}\n                style={{ cursor: 'pointer' }}\n              >\n                {userName || 'Пользователь'}\n              </div>\n              <img\n                src={avatarUrl}\n                alt=\"User\"\n                className={styles.userInfo__userIcon}\n              />\n            </div>\n          </div>\n          <button className={styles.logoutButton} onClick={handleLogoutClick}>Выйти</button>\n        </>\n      ) : (\n        <button className={styles.loginButton} onClick={handleLoginClick}>Войти</button>\n      )}\n    </div>\n  );\n};\n\nexport default UserBlock;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}