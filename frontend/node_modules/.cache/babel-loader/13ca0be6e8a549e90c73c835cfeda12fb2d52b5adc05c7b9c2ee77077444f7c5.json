{"ast":null,"code":"import React,{useEffect,useContext}from'react';import{useNavigate}from'react-router-dom';import styles from'./CartButton.module.scss';import cartIcon from'../../../assets/icons/shopping-cart.png';import{CartContext}from'../../../context/CartContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CartButton=()=>{const navigate=useNavigate();const{cartCount,updateCartCount}=useContext(CartContext);const token=localStorage.getItem('token');useEffect(()=>{if(token){fetchCartCount();}},[token]);const fetchCartCount=async()=>{try{const response=await fetch('http://localhost:8000/api/cart/',{headers:{'Authorization':\"Token \".concat(token)}});if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();if(Array.isArray(data)&&data.length>0&&Array.isArray(data[0].items)){updateCartCount(data[0].items.length);}else{console.error('Invalid cart data:',data);}}catch(error){console.error('Error fetching cart count:',error);}};const handleCartClick=()=>{if(cartCount>0){navigate('/cart');}};if(!token){return null;}return/*#__PURE__*/_jsxs(\"div\",{className:styles.cartButton,onClick:handleCartClick,children:[/*#__PURE__*/_jsx(\"img\",{src:cartIcon,alt:\"Cart Icon\"}),cartCount>0&&/*#__PURE__*/_jsx(\"span\",{className:styles.cartCount,children:cartCount})]});};export default CartButton;","map":{"version":3,"names":["React","useEffect","useContext","useNavigate","styles","cartIcon","CartContext","jsx","_jsx","jsxs","_jsxs","CartButton","navigate","cartCount","updateCartCount","token","localStorage","getItem","fetchCartCount","response","fetch","headers","concat","ok","Error","status","data","json","Array","isArray","length","items","console","error","handleCartClick","className","cartButton","onClick","children","src","alt"],"sources":["/home/kiipod/projects/slwrm/frontend/src/pages/ShopPage/CartButton/CartButton.jsx"],"sourcesContent":["import React, { useEffect, useContext } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport styles from './CartButton.module.scss';\nimport cartIcon from '../../../assets/icons/shopping-cart.png';\nimport { CartContext } from '../../../context/CartContext';\n\nconst CartButton = () => {\n  const navigate = useNavigate();\n  const { cartCount, updateCartCount } = useContext(CartContext);\n  const token = localStorage.getItem('token');\n\n  useEffect(() => {\n    if (token) {\n      fetchCartCount();\n    }\n  }, [token]);\n\n  const fetchCartCount = async () => {\n    try {\n      const response = await fetch('http://localhost:8000/api/cart/', {\n        headers: {\n          'Authorization': `Token ${token}`\n        }\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      const data = await response.json();\n      if (Array.isArray(data) && data.length > 0 && Array.isArray(data[0].items)) {\n        updateCartCount(data[0].items.length);\n      } else {\n        console.error('Invalid cart data:', data);\n      }\n    } catch (error) {\n      console.error('Error fetching cart count:', error);\n    }\n  };\n\n  const handleCartClick = () => {\n    if (cartCount > 0) {\n      navigate('/cart');\n    }\n  };\n\n  if (!token) {\n    return null;\n  }\n\n  return (\n    <div className={styles.cartButton} onClick={handleCartClick}>\n      <img src={cartIcon} alt=\"Cart Icon\"/>\n      {cartCount > 0 && <span className={styles.cartCount}>{cartCount}</span>}\n    </div>\n  );\n};\n\nexport default CartButton;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,UAAU,KAAQ,OAAO,CACpD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,MAAM,KAAM,0BAA0B,CAC7C,MAAO,CAAAC,QAAQ,KAAM,yCAAyC,CAC9D,OAASC,WAAW,KAAQ,8BAA8B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE3D,KAAM,CAAAC,UAAU,CAAGA,CAAA,GAAM,CACvB,KAAM,CAAAC,QAAQ,CAAGT,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAEU,SAAS,CAAEC,eAAgB,CAAC,CAAGZ,UAAU,CAACI,WAAW,CAAC,CAC9D,KAAM,CAAAS,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3ChB,SAAS,CAAC,IAAM,CACd,GAAIc,KAAK,CAAE,CACTG,cAAc,CAAC,CAAC,CAClB,CACF,CAAC,CAAE,CAACH,KAAK,CAAC,CAAC,CAEX,KAAM,CAAAG,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,iCAAiC,CAAE,CAC9DC,OAAO,CAAE,CACP,eAAe,UAAAC,MAAA,CAAWP,KAAK,CACjC,CACF,CAAC,CAAC,CACF,GAAI,CAACI,QAAQ,CAACI,EAAE,CAAE,CAChB,KAAM,IAAI,CAAAC,KAAK,wBAAAF,MAAA,CAAwBH,QAAQ,CAACM,MAAM,CAAE,CAAC,CAC3D,CACA,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAP,QAAQ,CAACQ,IAAI,CAAC,CAAC,CAClC,GAAIC,KAAK,CAACC,OAAO,CAACH,IAAI,CAAC,EAAIA,IAAI,CAACI,MAAM,CAAG,CAAC,EAAIF,KAAK,CAACC,OAAO,CAACH,IAAI,CAAC,CAAC,CAAC,CAACK,KAAK,CAAC,CAAE,CAC1EjB,eAAe,CAACY,IAAI,CAAC,CAAC,CAAC,CAACK,KAAK,CAACD,MAAM,CAAC,CACvC,CAAC,IAAM,CACLE,OAAO,CAACC,KAAK,CAAC,oBAAoB,CAAEP,IAAI,CAAC,CAC3C,CACF,CAAE,MAAOO,KAAK,CAAE,CACdD,OAAO,CAACC,KAAK,CAAC,4BAA4B,CAAEA,KAAK,CAAC,CACpD,CACF,CAAC,CAED,KAAM,CAAAC,eAAe,CAAGA,CAAA,GAAM,CAC5B,GAAIrB,SAAS,CAAG,CAAC,CAAE,CACjBD,QAAQ,CAAC,OAAO,CAAC,CACnB,CACF,CAAC,CAED,GAAI,CAACG,KAAK,CAAE,CACV,MAAO,KAAI,CACb,CAEA,mBACEL,KAAA,QAAKyB,SAAS,CAAE/B,MAAM,CAACgC,UAAW,CAACC,OAAO,CAAEH,eAAgB,CAAAI,QAAA,eAC1D9B,IAAA,QAAK+B,GAAG,CAAElC,QAAS,CAACmC,GAAG,CAAC,WAAW,CAAC,CAAC,CACpC3B,SAAS,CAAG,CAAC,eAAIL,IAAA,SAAM2B,SAAS,CAAE/B,MAAM,CAACS,SAAU,CAAAyB,QAAA,CAAEzB,SAAS,CAAO,CAAC,EACpE,CAAC,CAEV,CAAC,CAED,cAAe,CAAAF,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}