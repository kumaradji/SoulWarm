{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../../context/AuthContext';import styles from'./ChangePassword.module.scss';import{FaEye,FaEyeSlash}from'react-icons/fa';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChangePassword=()=>{const[currentPassword,setCurrentPassword]=useState('');const[newPassword,setNewPassword]=useState('');const[confirmPassword,setConfirmPassword]=useState('');const[showPassword,setShowPassword]=useState(false);const[error,setError]=useState(null);const[success,setSuccess]=useState(null);const{user}=useAuth();const navigate=useNavigate();const handleChangePassword=async e=>{e.preventDefault();if(newPassword!==confirmPassword){setError('Новые пароли не совпадают');return;}try{const token=localStorage.getItem('token');// Получаем токен из локального хранилища\nconst response=await fetch('http://localhost:8000/api/change-password/',{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Token \".concat(token)// Передаем токен в заголовке\n},body:JSON.stringify({currentPassword,newPassword})});if(response.ok){setSuccess('Пароль успешно изменен');setTimeout(()=>navigate('/profile'),2000);// Перенаправляем на профиль через 2 секунды\n}else{const errorData=await response.json();setError(errorData.message||'Ошибка при изменении пароля');}}catch(error){console.error('Ошибка при изменении пароля:',error);setError('Ошибка при изменении пароля');}};return/*#__PURE__*/_jsx(\"div\",{className:styles.changePassword,children:/*#__PURE__*/_jsx(\"div\",{className:styles.changePasswordContainer,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.changePasswordFormWrapper,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:styles.error,children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:styles.success,children:success}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleChangePassword,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.formGroup,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"currentPassword\",children:\"\\u0422\\u0435\\u043A\\u0443\\u0449\\u0438\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C:\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.passwordWrapper,children:[/*#__PURE__*/_jsx(\"input\",{type:showPassword?'text':'password',id:\"currentPassword\",value:currentPassword,onChange:e=>setCurrentPassword(e.target.value),required:true}),/*#__PURE__*/_jsx(\"span\",{className:styles.passwordToggle,onClick:()=>setShowPassword(!showPassword),children:showPassword?/*#__PURE__*/_jsx(FaEyeSlash,{}):/*#__PURE__*/_jsx(FaEye,{})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.formGroup,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newPassword\",children:\"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C:\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.passwordWrapper,children:[/*#__PURE__*/_jsx(\"input\",{type:showPassword?'text':'password',id:\"newPassword\",value:newPassword,onChange:e=>setNewPassword(e.target.value),required:true}),/*#__PURE__*/_jsx(\"span\",{className:styles.passwordToggle,onClick:()=>setShowPassword(!showPassword),children:showPassword?/*#__PURE__*/_jsx(FaEyeSlash,{}):/*#__PURE__*/_jsx(FaEye,{})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.formGroup,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"confirmPassword\",children:\"\\u041F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0434\\u0438\\u0442\\u0435 \\u043D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C:\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.passwordWrapper,children:[/*#__PURE__*/_jsx(\"input\",{type:showPassword?'text':'password',id:\"confirmPassword\",value:confirmPassword,onChange:e=>setConfirmPassword(e.target.value),required:true}),/*#__PURE__*/_jsx(\"span\",{className:styles.passwordToggle,onClick:()=>setShowPassword(!showPassword),children:showPassword?/*#__PURE__*/_jsx(FaEyeSlash,{}):/*#__PURE__*/_jsx(FaEye,{})})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"})]})]})})});};export default ChangePassword;","map":{"version":3,"names":["React","useState","useNavigate","useAuth","styles","FaEye","FaEyeSlash","jsx","_jsx","jsxs","_jsxs","ChangePassword","currentPassword","setCurrentPassword","newPassword","setNewPassword","confirmPassword","setConfirmPassword","showPassword","setShowPassword","error","setError","success","setSuccess","user","navigate","handleChangePassword","e","preventDefault","token","localStorage","getItem","response","fetch","method","headers","concat","body","JSON","stringify","ok","setTimeout","errorData","json","message","console","className","changePassword","children","changePasswordContainer","changePasswordFormWrapper","onSubmit","formGroup","htmlFor","passwordWrapper","type","id","value","onChange","target","required","passwordToggle","onClick"],"sources":["/home/kiipod/projects/slwrm/frontend/src/components/ChangePassword/ChangePassword.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../context/AuthContext';\nimport styles from './ChangePassword.module.scss';\nimport { FaEye, FaEyeSlash } from 'react-icons/fa';\n\nconst ChangePassword = () => {\n  const [currentPassword, setCurrentPassword] = useState('');\n  const [newPassword, setNewPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [showPassword, setShowPassword] = useState(false);\n  const [error, setError] = useState(null);\n  const [success, setSuccess] = useState(null);\n  const { user } = useAuth();\n  const navigate = useNavigate();\n\n  const handleChangePassword = async (e) => {\n    e.preventDefault();\n\n    if (newPassword !== confirmPassword) {\n      setError('Новые пароли не совпадают');\n      return;\n    }\n\n    try {\n      const token = localStorage.getItem('token'); // Получаем токен из локального хранилища\n      const response = await fetch('http://localhost:8000/api/change-password/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Token ${token}`, // Передаем токен в заголовке\n        },\n        body: JSON.stringify({ currentPassword, newPassword }),\n      });\n\n      if (response.ok) {\n        setSuccess('Пароль успешно изменен');\n        setTimeout(() => navigate('/profile'), 2000); // Перенаправляем на профиль через 2 секунды\n      } else {\n        const errorData = await response.json();\n        setError(errorData.message || 'Ошибка при изменении пароля');\n      }\n    } catch (error) {\n      console.error('Ошибка при изменении пароля:', error);\n      setError('Ошибка при изменении пароля');\n    }\n  };\n\n  return (\n    <div className={styles.changePassword}>\n      <div className={styles.changePasswordContainer}>\n        <div className={styles.changePasswordFormWrapper}>\n          <h2>Изменить пароль</h2>\n          {error && <div className={styles.error}>{error}</div>}\n          {success && <div className={styles.success}>{success}</div>}\n          <form onSubmit={handleChangePassword}>\n            <div className={styles.formGroup}>\n              <label htmlFor=\"currentPassword\">Текущий пароль:</label>\n              <div className={styles.passwordWrapper}>\n                <input\n                  type={showPassword ? 'text' : 'password'}\n                  id=\"currentPassword\"\n                  value={currentPassword}\n                  onChange={(e) => setCurrentPassword(e.target.value)}\n                  required\n                />\n                <span\n                  className={styles.passwordToggle}\n                  onClick={() => setShowPassword(!showPassword)}\n                >\n                  {showPassword ? <FaEyeSlash /> : <FaEye />}\n                </span>\n              </div>\n            </div>\n            <div className={styles.formGroup}>\n              <label htmlFor=\"newPassword\">Новый пароль:</label>\n              <div className={styles.passwordWrapper}>\n                <input\n                  type={showPassword ? 'text' : 'password'}\n                  id=\"newPassword\"\n                  value={newPassword}\n                  onChange={(e) => setNewPassword(e.target.value)}\n                  required\n                />\n                <span\n                  className={styles.passwordToggle}\n                  onClick={() => setShowPassword(!showPassword)}\n                >\n                  {showPassword ? <FaEyeSlash /> : <FaEye />}\n                </span>\n              </div>\n            </div>\n            <div className={styles.formGroup}>\n              <label htmlFor=\"confirmPassword\">Подтвердите новый пароль:</label>\n              <div className={styles.passwordWrapper}>\n                <input\n                  type={showPassword ? 'text' : 'password'}\n                  id=\"confirmPassword\"\n                  value={confirmPassword}\n                  onChange={(e) => setConfirmPassword(e.target.value)}\n                  required\n                />\n                <span\n                  className={styles.passwordToggle}\n                  onClick={() => setShowPassword(!showPassword)}\n                >\n                  {showPassword ? <FaEyeSlash /> : <FaEye />}\n                </span>\n              </div>\n            </div>\n            <button type=\"submit\">Изменить пароль</button>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ChangePassword;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}